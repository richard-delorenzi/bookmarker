(function () {
    function selectedText(){
	var t;
	try {
	    t= ((window.getSelection && window.getSelection()) ||
		(document.getSelection && document.getSelection()) ||
		(document.selection &&
		 document.selection.createRange &&
		 document.selection.createRange().text));
	}
	catch(e){ 
	    t = '';
	}
	return t;
    }
    
    function link() {
	return 'http://bookmarkdb/add'+
	    '?url='   +encodeURIComponent(location.href)+
	    '&title=' +encodeURIComponent(document.title)+
	    '&description=' +encodeURIComponent(selectedText());
    }

    window.open(link());
})();

