#!/usr/bin/python3

import re
import json
import urllib.request

def is_dateFormat(data):
    return re.match (
	"\d{4}\-\d{2}\-\d{2}T\d{2}:\d{2}:\d{2}(\.\d*)?Z",
        data )

def pageContent(page):
    return urllib.request.urlopen(
        page
    ).read().decode("unicode_escape")    

def pageData(page):
    rawdata=pageContent(
        page
    )
    return json.loads(rawdata)

def candidateRows():
    data=pageData(
        "http://mycouchdb:80/bookmarks/_design/design/_view/webmarks-by-date"
    )
    return data["rows"]

    
def IDs():
    for row in candidateRows():
        date = row["key"][0]
        id = row["id"]
        if not is_dateFormat(date):
            yield (id)

def docWithId(id):
    pass
            
for id in IDs():
    print (id)
